%#!luajitlatex -shell-escape kbtable
\RequirePackage{luatex85}
\documentclass[landscape]{article}
\usepackage{fontspec,unicode-math,xcolor,graphicx}
\newdimen\DX
\DX=1.5\baselineskip
\paperwidth=28.666\dimexpr\DX+\fboxsep+\fboxrule\relax
\advance\paperwidth20pt
\paperheight=20\baselineskip
\advance\paperheight20pt
\usepackage[margin=10pt]{geometry}
\def\pgfsysdriver{pgfsys-pdftex.def}
\usepackage{menukeys}
\setmainfont{TeX Gyre Heros}
\setsansfont[Ligatures=TeX]{DejaVu Sans}
\setmonofont{lmmonoltcond10-regular}
\setmathfont{XITS Math}

\ifdefined\BACKCOLOR
  \def\FORECOLOR{white}
  \def\LINECOLOR{black!33!white}
  \definecolor{cyan}{rgb}{0,1,1}
  \definecolor{red}{rgb}{0.25,1,0.25}
\else
  \def\FORECOLOR{black}
  \def\BACKCOLOR{white}
  \def\LINECOLOR{black!66!white}
  \definecolor{cyan}{rgb}{0,0.25,1}
\fi

\def\DXV#1#2{\textcolor{#1}{\large\hbox to1em{\strut\hss\smash{#2}}}}
\pagecolor{\BACKCOLOR}
\begin{document}
\sf\parindent0pt

\def\K#1#2#3#4#5#6{%
\fbox{\vbox{\hsize=2\DX{%
  \noindent\smash{\textcolor{\FORECOLOR}{\rm\large\strut#2}}%
    \hfill \DXV{cyan}{#6}\DXV{red}{#4}\\
  \textcolor{\FORECOLOR}{\null\rm\large\strut#1}
	\hfill\DXV{cyan}{#5}\DXV{red}{#3}%
}}}\ignorespaces}
\def\W#1#2{%
\fbox{\vbox{\hsize=#1\dimexpr\DX+\fboxsep+\fboxrule\relax
\advance\hsize-2\fboxrule\advance\hsize-2\fboxsep{%
  \noindent\large\strut\smash{%
    \raisebox{-.5\DX}{\normalsize\rm\textcolor{\LINECOLOR}{#2}}}\\\ \strut
}}}%
\ignorespaces}

\def\X#1#2{%
\fbox{\vbox{\hsize=#1\dimexpr\DX+\fboxsep+\fboxrule\relax
\advance\hsize-2\fboxrule\advance\hsize-2\fboxsep{%
  \noindent\null\hfill\Large\strut\rm\textcolor{\LINECOLOR}{#2}\hfill\null}}}%
\ignorespaces}

\color{\LINECOLOR}

\K{\char`\`}{\char`\~}{≠}{≒}{}{}
\K{1}{!}{¬}{△}{¡}{¹}
\K{2}{@}{∅}{⊆}{²}{}
\K{3}{\#}{∽}{}{³}{}
\K{4}{\$}{∞}{}{¤}{£}
\K{5}{\%}{\scalebox{0.7}[1]{‰}}{}{€}{}
\K{6}{\char`\^}{∨}{∪}{¼}{}
\K{7}{\&}{∧}{∩}{½}{}
\K{8}{$*$}{ℵ}{}{¾}{}
\K{9}{(}{⌈}{⌊}{‘}{}
\K{0}{)}{⌉}{⌋}{’}{}
\K{-}{\_}{≅}{≃}{¥}{}
\K{=}{+}{≡}{∼}{×}{÷}
\W{2.66}{\backspace\,BS}

\kern-5.5pt
\null
\W{2.66}{Tab\,\tabwin}
\K{}{Q}{⊂}{ℚ}{}{Ä}
\K{}{W}{ω}{Ω}{}{Å}
\K{}{E}{ε}{∃}{}{É}
\K{}{R}{ρ}{ℝ}{®}{}
\K{}{T}{τ}{⊤}{}{Þ}
\K{}{Y}{η}{Η}{}{Ü}
\K{}{U}{υ}{Υ}{}{Ú}
\K{}{I}{ι}{∈}{}{Í}
\K{}{O}{ο}{∉}{}{Ó}
\K{}{P}{π}{Π}{}{Ö}
\K{[}{\{}{$〈$}{⟦}{«}{“}
\K{]}{\}}{$〉$}{⟧}{»}{”}
\K{\char`\\}{|}{‖}{}{¬}{¦}

\kern-5.5pt
\null
\W{3.33}{CapsLk\,\capslockmac}
\K{}{A}{α}{∀}{}{Á}
\K{}{S}{σ}{Σ}{ß}{§}
\K{}{D}{δ}{Δ}{}{Ð}
\K{}{F}{φ}{Φ}{ϕ}{Φ}
\K{}{G}{γ}{Γ}{}{}
\K{}{H}{θ}{Θ}{}{}
\K{}{J}{⊦}{⊩}{}{}
\K{}{K}{κ}{Κ}{}{Œ}
\K{}{L}{λ}{Λ}{}{Ø}
\K{;}{:}{∴}{∵}{¶}{°}
\K{'}{"}{±}{∓}{}{}
\W{3.33}{\returnwin\,Enter}

\kern-5.5pt
\null
\W4{\shift Shift}
\K{}{Z}{ζ}{ℤ}{}{Æ}
\K{}{X}{ξ}{Ξ}{}{}
\K{}{C}{χ}{ℂ}{©}{¢}
\K{}{V}{ψ}{Ψ}{}{}
\K{}{B}{β}{⊥}{}{}
\K{}{N}{ν}{ℕ}{}{Ñ}
\K{}{M}{μ}{⊧}{µ}{}
\K{,}{<}{≤}{≦}{}{Ç}
\K{.}{>}{≥}{≧}{}{}
\K{/}{?}{↔}{⇔}{¿}{}
\W{4.66}{\shift\,Shift}

\kern-5.5pt
\null
\W2{Fn}
\W2{Ctrl}
\W2{Win}%"
\W2{Alt}
\W{10}{}
\W2{\textcolor{red}{\kern-.1emSwitch}}
\W2{\textcolor{cyan}{\kern-.1emAltGr}}
\W2{Ctrl}
\hskip1.55\dimexpr\DX+\fboxsep+\fboxrule\relax
\smash{\raisebox{\dimexpr\baselineskip+.2pt}{\X{1.56}{↑}}}
\hskip1.55\dimexpr\DX+\fboxsep+\fboxrule\relax

\kern-17pt
\null
\hskip24\dimexpr\DX+\fboxsep+\fboxrule\relax
\X{1.55}{←}\X{1.56}{↓}\X{1.55}{→}

\def\TEMP{white}
\catcode`\&=12
\ifx\BACKCOLOR\TEMP
\directlua{ os.execute("\luaescapestring{%
  luajitlatex -jobname=kbtable-blk %
  '\string\def\string\BACKCOLOR{black}\string\input\space kbtable.tex' &>/dev/null
  && convert -bordercolor black -geometry 1600x900 -resize 1600 -density 300  -border 0x104 kbtable-blk.pdf kbd.png
}")}
\fi
\end{document}
